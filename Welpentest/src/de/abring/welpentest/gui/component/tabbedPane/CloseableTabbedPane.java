/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package de.abring.welpentest.gui.component.tabbedPane;

import de.abring.welpentest.gui.component.MainPage;
import de.abring.welpentest.gui.dialog.MSG;
import java.awt.Color;
import java.awt.Component;
import java.awt.Graphics;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.Image;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JButton;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JTabbedPane;

/**
 *
 * @author Karima
 */
public class CloseableTabbedPane extends JTabbedPane{
    
    private Color background = Color.WHITE;
    
    private Image bg = new javax.swing.ImageIcon(getClass().getResource("/de/abring/welpentest/gui/component/tabbedPane/ILe-Logo.png")).getImage();
    public CloseableTabbedPane() {
        super();
    }

    public CloseableTabbedPane(int i) {
        super(i);
    }

    public CloseableTabbedPane(int i, int i1) {
        super(i, i1);
    }
    
    @Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        int w1 = getSize().width;
        int h1 = getSize().height;
        int w2 = bg.getWidth(null);
        int h2 = bg.getHeight(null);

        g.drawImage(bg, (w1 - w2) / 2, (h1 - h2) / 2, null);
        //g.drawImage(bg, 0, 0, getWidth(), getHeight(), this);
    }

    /**
     *
     * @param title
     * @param cmpnt
     */
    @Override
    public void addTab(String title, Component cmpnt) {
        super.addTab(title, cmpnt);
        int index = indexOfComponent(cmpnt);
        TabHeader tabHeader = new TabHeader();
        tabHeader.setOpaque(false);
        tabHeader.setTitle(title);
        GridBagConstraints gbc = new GridBagConstraints();
        
        setTabComponentAt(index, tabHeader);
        getTabComponentAt(index).setSize(300, 24);
        
        tabHeader.addXActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent ae) {
                
                if (cmpnt instanceof MainPage) {
                    MainPage mainPage = ((MainPage) cmpnt);
                    if (!mainPage.isDataSaved())
                        if (MSG.msgSaveBeforeClose(cmpnt, mainPage.getZwinger().getName()))
                            mainPage.saveMain();
                }
                remove(cmpnt);
                tabHeader.removeXActionListener(this);
            }
        });
        tabHeader.addLabeLMouseListener(new java.awt.event.MouseAdapter() {
            @Override
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                setSelectedComponent(cmpnt);
            }
            @Override
            public void mouseEntered(java.awt.event.MouseEvent evt) {
                background = getBackground();
                setBackground(Color.DARK_GRAY);
            }
            @Override
            public void mouseExited(java.awt.event.MouseEvent evt) {
                setBackground(background);
            }
        });
    }
}

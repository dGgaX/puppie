/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package de.abring.welpentest.gui.component;

import de.abring.welpentest.data.Gender;
import de.abring.welpentest.data.Welpe;
import de.abring.welpentest.data.Wuerfe;
import de.abring.welpentest.data.Wurf;
import de.abring.welpentest.data.WurfNamen;
import de.abring.welpentest.data.Zwinger;
import de.abring.welpentest.data.tests.V6MTestData;
import de.abring.welpentest.data.tests.VTestData;
import de.abring.welpentest.data.tests.VePTestData;
import de.abring.welpentest.gui.Welpentest;
import de.abring.welpentest.gui.component.desktopPane.ILeDesktopPane;
import de.abring.welpentest.gui.dialog.FileIO;
import de.abring.welpentest.gui.model.GenderComboBoxModel;
import de.abring.welpentest.gui.model.TestListModel;
import de.abring.welpentest.gui.model.WelpeListModel;
import de.abring.welpentest.gui.model.WurfListModel;
import de.abring.welpentest.gui.model.WurfNamenComboBoxModel;
import java.awt.Color;
import java.awt.Component;
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.ObjectOutputStream;
import java.util.Date;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.DefaultListCellRenderer;
import javax.swing.JList;
import org.jdesktop.swingx.calendar.DateSelectionModel;
import org.jdesktop.swingx.calendar.DateUtils;
import org.jdesktop.swingx.event.DateSelectionEvent;
import org.jdesktop.swingx.event.DateSelectionListener;


/**
 *
 * @author Andreas
 */
public class MainPageFrame extends javax.swing.JInternalFrame {

    /**
     * @return the dataSaved
     */
    public boolean isDataSaved() {
        return dataSaved;
    }

    /**
     * @param dataSaved the dataSaved to set
     */
    public void setDataSaved(boolean dataSaved) {
        this.dataSaved = dataSaved;
    }

    private final Zwinger zwinger;
    private WurfNamenComboBoxModel wurfNamenComboBoxModel;
    private GenderComboBoxModel genderComboBoxModel;
    private WurfListModel wurfListModel;
    private WelpeListModel welpeListModel;
    private TestListModel testListModel;
    private Wurf activWurf = null;
    private Welpe activWelpe = null;
    private File filename;
    private boolean dataSaved;
    private VePTestFrame vepTest = null;

    /**
     * Creates new form MainPage
     * @param zwinger
     * @param vepTest
     */
    public MainPageFrame(Zwinger zwinger, VePTestFrame vepTest) {
        this.zwinger = zwinger;
        this.dataSaved = true;
        this.vepTest = vepTest;
        initComponents();
        initOtherComponents();
        loadZwinger();
    }

    /**
     * Creates new form MainPage
     * @param vepTest
     */
    public MainPageFrame(VePTestFrame vepTest) {
        this.zwinger = new Zwinger("");
        this.dataSaved = false;
        this.vepTest = vepTest;
        initComponents();
        initOtherComponents();
        loadZwinger();
    }
    
    /**
     * Creates new form MainPage
     * @param name
     * @param vepTest
     */
    public MainPageFrame(String name, VePTestFrame vepTest) {
        this.zwinger = new Zwinger(name);
        this.dataSaved = false;
        this.vepTest = vepTest;
        initComponents();
        initOtherComponents();
        loadZwinger();
    }
    
    
    private void initOtherComponents() {
        this.filename = new File("");
        this.wurfNamenComboBoxModel = new WurfNamenComboBoxModel(Wuerfe.ALL_WUERFE());
        this.genderComboBoxModel = new GenderComboBoxModel(Gender.ALL_GENDER());
        this.wurfListModel = new WurfListModel(this.zwinger.getWuerfe());
        this.jCbxWuerfe.setModel(this.wurfNamenComboBoxModel);
        this.jCbxWuerfe.setSelectedIndex(0);
        this.jCbxWelpeGender.setModel(genderComboBoxModel);
        this.jCbxWelpeGender.setSelectedIndex(2);
        this.jLstWuerfe.setModel(wurfListModel);
        
        this.jXMVBirthday.setSelectionMode(DateSelectionModel.SelectionMode.SINGLE_SELECTION);
        
        
        this.jXMVBirthday.getSelectionModel().addDateSelectionListener(new DateSelectionListener(){
            @Override
            public void valueChanged(DateSelectionEvent ev) {
                if (ev.getEventType() == DateSelectionEvent.EventType.DATES_SET) {
                    if (activWurf != null) {
                            activWurf.setGeburtstag(ev.getSelection().first());
                            jXMVBirthday.setFlaggedDates(activWurf.getGeburtstag());
                    }
                } 
            }
        });
        setFrameIcon(new javax.swing.ImageIcon(getClass().getResource("/de/abring/welpentest/gui/images/Logo64.png")));
    
        this.jLstWelpeTests.setCellRenderer(new DefaultListCellRenderer() {

            @Override
            public Component getListCellRendererComponent(JList list, Object value, int index, boolean isSelected, boolean cellHasFocus) {
                Component c = super.getListCellRendererComponent(list, value, index, isSelected, cellHasFocus);
                if (value instanceof VePTestData) {
                    VePTestData data = (VePTestData) value;
                    if (!data.getCrossBorder().isEmpty()) {
                        setForeground(Color.GREEN);
                    } else {
                        setForeground(Color.RED);
                    }
                }   
                return c;
            }

       });
                
    }
    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPneWuerfe = new javax.swing.JPanel();
        jSclPneWuerfe = new javax.swing.JScrollPane();
        jLstWuerfe = new javax.swing.JList<>();
        jCbxWuerfe = new javax.swing.JComboBox<>();
        jBtnWuerfeAdd = new javax.swing.JButton();
        jBtnWuerfeRemove = new javax.swing.JButton();
        jPneBirthday = new javax.swing.JPanel();
        jXMVBirthday = new org.jdesktop.swingx.JXMonthView();
        jPanelWelpen = new javax.swing.JPanel();
        jSclPneWelpen = new javax.swing.JScrollPane();
        jLstWelpen = new javax.swing.JList<>();
        jBtnWelpenAdd = new javax.swing.JButton();
        jBtnWelpenRemove = new javax.swing.JButton();
        jPneWelpe = new javax.swing.JPanel();
        jTxtWelpeName = new javax.swing.JTextField();
        jCbxWelpeGender = new javax.swing.JComboBox<>();
        jPneWelpeExtras = new javax.swing.JPanel();
        jSclPaneWelpeExtras = new javax.swing.JScrollPane();
        jTxtWelpeExtras = new javax.swing.JTextArea();
        jPneWelpeTests = new javax.swing.JPanel();
        jSclPneWelpeTests = new javax.swing.JScrollPane();
        jLstWelpeTests = new javax.swing.JList<>();
        jBtnWelpeVePAdd = new javax.swing.JButton();
        jBtnWelpeV6MAdd = new javax.swing.JButton();
        jBtnWelpeTestRemove = new javax.swing.JButton();
        jPanel1 = new javax.swing.JPanel();
        jTxtZwingerName = new javax.swing.JTextField();

        setBorder(new javax.swing.border.LineBorder(new java.awt.Color(204, 204, 255), 3, true));
        setClosable(true);
        setIconifiable(true);
        setMaximizable(true);
        setResizable(true);
        setTitle("MainPage");
        addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                formPropertyChange(evt);
            }
        });

        jPneWuerfe.setBorder(javax.swing.BorderFactory.createTitledBorder("WÃ¼rfe:"));

        jLstWuerfe.setFont(new java.awt.Font("Tahoma", 0, 24)); // NOI18N
        jLstWuerfe.setSelectionMode(javax.swing.ListSelectionModel.SINGLE_SELECTION);
        jLstWuerfe.addListSelectionListener(new javax.swing.event.ListSelectionListener() {
            public void valueChanged(javax.swing.event.ListSelectionEvent evt) {
                jLstWuerfeValueChanged(evt);
            }
        });
        jSclPneWuerfe.setViewportView(jLstWuerfe);

        jCbxWuerfe.setFont(new java.awt.Font("Tahoma", 0, 24)); // NOI18N

        jBtnWuerfeAdd.setFont(new java.awt.Font("Tahoma", 0, 24)); // NOI18N
        jBtnWuerfeAdd.setText("add");
        jBtnWuerfeAdd.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBtnWuerfeAddActionPerformed(evt);
            }
        });

        jBtnWuerfeRemove.setFont(new java.awt.Font("Tahoma", 0, 24)); // NOI18N
        jBtnWuerfeRemove.setText("remove");
        jBtnWuerfeRemove.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBtnWuerfeRemoveActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPneWuerfeLayout = new javax.swing.GroupLayout(jPneWuerfe);
        jPneWuerfe.setLayout(jPneWuerfeLayout);
        jPneWuerfeLayout.setHorizontalGroup(
            jPneWuerfeLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPneWuerfeLayout.createSequentialGroup()
                .addComponent(jBtnWuerfeAdd, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jBtnWuerfeRemove, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
            .addComponent(jSclPneWuerfe, javax.swing.GroupLayout.DEFAULT_SIZE, 323, Short.MAX_VALUE)
            .addComponent(jCbxWuerfe, javax.swing.GroupLayout.Alignment.TRAILING, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        jPneWuerfeLayout.setVerticalGroup(
            jPneWuerfeLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPneWuerfeLayout.createSequentialGroup()
                .addComponent(jSclPneWuerfe)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jCbxWuerfe, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(8, 8, 8)
                .addGroup(jPneWuerfeLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jBtnWuerfeRemove)
                    .addComponent(jBtnWuerfeAdd)))
        );

        jPneBirthday.setBorder(javax.swing.BorderFactory.createTitledBorder("Geburtstag:"));

        jXMVBirthday.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        jXMVBirthday.addComponentListener(new java.awt.event.ComponentAdapter() {
            public void componentResized(java.awt.event.ComponentEvent evt) {
                jXMVBirthdayComponentResized(evt);
            }
        });

        javax.swing.GroupLayout jPneBirthdayLayout = new javax.swing.GroupLayout(jPneBirthday);
        jPneBirthday.setLayout(jPneBirthdayLayout);
        jPneBirthdayLayout.setHorizontalGroup(
            jPneBirthdayLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jXMVBirthday, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        jPneBirthdayLayout.setVerticalGroup(
            jPneBirthdayLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jXMVBirthday, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );

        jPanelWelpen.setBorder(javax.swing.BorderFactory.createTitledBorder("Welpen:"));

        jLstWelpen.setFont(new java.awt.Font("Tahoma", 0, 24)); // NOI18N
        jLstWelpen.setSelectionMode(javax.swing.ListSelectionModel.SINGLE_SELECTION);
        jLstWelpen.addListSelectionListener(new javax.swing.event.ListSelectionListener() {
            public void valueChanged(javax.swing.event.ListSelectionEvent evt) {
                jLstWelpenValueChanged(evt);
            }
        });
        jSclPneWelpen.setViewportView(jLstWelpen);

        jBtnWelpenAdd.setFont(new java.awt.Font("Tahoma", 0, 24)); // NOI18N
        jBtnWelpenAdd.setText("add");
        jBtnWelpenAdd.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBtnWelpenAddActionPerformed(evt);
            }
        });

        jBtnWelpenRemove.setFont(new java.awt.Font("Tahoma", 0, 24)); // NOI18N
        jBtnWelpenRemove.setText("remove");
        jBtnWelpenRemove.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBtnWelpenRemoveActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanelWelpenLayout = new javax.swing.GroupLayout(jPanelWelpen);
        jPanelWelpen.setLayout(jPanelWelpenLayout);
        jPanelWelpenLayout.setHorizontalGroup(
            jPanelWelpenLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jSclPneWelpen, javax.swing.GroupLayout.DEFAULT_SIZE, 331, Short.MAX_VALUE)
            .addGroup(jPanelWelpenLayout.createSequentialGroup()
                .addComponent(jBtnWelpenAdd, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jBtnWelpenRemove, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanelWelpenLayout.setVerticalGroup(
            jPanelWelpenLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanelWelpenLayout.createSequentialGroup()
                .addComponent(jSclPneWelpen)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanelWelpenLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jBtnWelpenAdd)
                    .addComponent(jBtnWelpenRemove)))
        );

        jPneWelpe.setBorder(javax.swing.BorderFactory.createTitledBorder("Welpe:"));

        jTxtWelpeName.setFont(new java.awt.Font("Tahoma", 0, 24)); // NOI18N
        jTxtWelpeName.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        jTxtWelpeName.addCaretListener(new javax.swing.event.CaretListener() {
            public void caretUpdate(javax.swing.event.CaretEvent evt) {
                jTxtWelpeNameCaretUpdate(evt);
            }
        });
        jTxtWelpeName.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                jTxtWelpeNameFocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                jTxtWelpeNameFocusLost(evt);
            }
        });
        jTxtWelpeName.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jTxtWelpeNameActionPerformed(evt);
            }
        });

        jCbxWelpeGender.setFont(new java.awt.Font("Tahoma", 0, 24)); // NOI18N
        jCbxWelpeGender.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                jCbxWelpeGenderItemStateChanged(evt);
            }
        });
        jCbxWelpeGender.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jCbxWelpeGenderActionPerformed(evt);
            }
        });

        jPneWelpeExtras.setBorder(javax.swing.BorderFactory.createTitledBorder("Besonderheiten:"));

        jTxtWelpeExtras.setColumns(16);
        jTxtWelpeExtras.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jTxtWelpeExtras.setRows(5);
        jTxtWelpeExtras.setTabSize(2);
        jTxtWelpeExtras.addCaretListener(new javax.swing.event.CaretListener() {
            public void caretUpdate(javax.swing.event.CaretEvent evt) {
                jTxtWelpeExtrasCaretUpdate(evt);
            }
        });
        jSclPaneWelpeExtras.setViewportView(jTxtWelpeExtras);

        javax.swing.GroupLayout jPneWelpeExtrasLayout = new javax.swing.GroupLayout(jPneWelpeExtras);
        jPneWelpeExtras.setLayout(jPneWelpeExtrasLayout);
        jPneWelpeExtrasLayout.setHorizontalGroup(
            jPneWelpeExtrasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jSclPaneWelpeExtras, javax.swing.GroupLayout.DEFAULT_SIZE, 312, Short.MAX_VALUE)
        );
        jPneWelpeExtrasLayout.setVerticalGroup(
            jPneWelpeExtrasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jSclPaneWelpeExtras, javax.swing.GroupLayout.DEFAULT_SIZE, 147, Short.MAX_VALUE)
        );

        jPneWelpeTests.setBorder(javax.swing.BorderFactory.createTitledBorder("Tests:"));

        jLstWelpeTests.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLstWelpeTests.setSelectionMode(javax.swing.ListSelectionModel.SINGLE_SELECTION);
        jLstWelpeTests.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jLstWelpeTestsMouseClicked(evt);
            }
        });
        jSclPneWelpeTests.setViewportView(jLstWelpeTests);

        jBtnWelpeVePAdd.setFont(new java.awt.Font("Tahoma", 0, 24)); // NOI18N
        jBtnWelpeVePAdd.setText("VeP");
        jBtnWelpeVePAdd.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBtnWelpeVePAddActionPerformed(evt);
            }
        });

        jBtnWelpeV6MAdd.setFont(new java.awt.Font("Tahoma", 0, 24)); // NOI18N
        jBtnWelpeV6MAdd.setText("V6M");
        jBtnWelpeV6MAdd.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBtnWelpeV6MAddActionPerformed(evt);
            }
        });

        jBtnWelpeTestRemove.setFont(new java.awt.Font("Tahoma", 0, 24)); // NOI18N
        jBtnWelpeTestRemove.setText("remove");
        jBtnWelpeTestRemove.setToolTipText("");
        jBtnWelpeTestRemove.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBtnWelpeTestRemoveActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPneWelpeTestsLayout = new javax.swing.GroupLayout(jPneWelpeTests);
        jPneWelpeTests.setLayout(jPneWelpeTestsLayout);
        jPneWelpeTestsLayout.setHorizontalGroup(
            jPneWelpeTestsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPneWelpeTestsLayout.createSequentialGroup()
                .addComponent(jBtnWelpeVePAdd, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jBtnWelpeV6MAdd, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jBtnWelpeTestRemove, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
            .addComponent(jSclPneWelpeTests)
        );
        jPneWelpeTestsLayout.setVerticalGroup(
            jPneWelpeTestsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPneWelpeTestsLayout.createSequentialGroup()
                .addComponent(jSclPneWelpeTests, javax.swing.GroupLayout.DEFAULT_SIZE, 144, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPneWelpeTestsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jBtnWelpeVePAdd)
                    .addComponent(jBtnWelpeTestRemove)
                    .addComponent(jBtnWelpeV6MAdd, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
        );

        javax.swing.GroupLayout jPneWelpeLayout = new javax.swing.GroupLayout(jPneWelpe);
        jPneWelpe.setLayout(jPneWelpeLayout);
        jPneWelpeLayout.setHorizontalGroup(
            jPneWelpeLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jCbxWelpeGender, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addComponent(jTxtWelpeName, javax.swing.GroupLayout.Alignment.TRAILING)
            .addComponent(jPneWelpeExtras, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addComponent(jPneWelpeTests, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        jPneWelpeLayout.setVerticalGroup(
            jPneWelpeLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPneWelpeLayout.createSequentialGroup()
                .addComponent(jTxtWelpeName, javax.swing.GroupLayout.PREFERRED_SIZE, 50, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jCbxWelpeGender, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPneWelpeExtras, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPneWelpeTests, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder("Zwinger:"));

        jTxtZwingerName.setFont(new java.awt.Font("Tahoma", 0, 36)); // NOI18N
        jTxtZwingerName.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        jTxtZwingerName.setText("Name");
        jTxtZwingerName.addCaretListener(new javax.swing.event.CaretListener() {
            public void caretUpdate(javax.swing.event.CaretEvent evt) {
                jTxtZwingerNameCaretUpdate(evt);
            }
        });
        jTxtZwingerName.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                jTxtZwingerNameFocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                jTxtZwingerNameFocusLost(evt);
            }
        });
        jTxtZwingerName.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jTxtZwingerNameActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jTxtZwingerName)
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jTxtZwingerName, javax.swing.GroupLayout.PREFERRED_SIZE, 65, javax.swing.GroupLayout.PREFERRED_SIZE)
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(jPneWuerfe, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanelWelpen, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPneBirthday, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPneWelpe, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
            .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jPneBirthday, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jPanelWelpen, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addComponent(jPneWuerfe, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPneWelpe, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void formPropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_formPropertyChange
        if (evt.getPropertyName().equals("maximum")) {
            if ((boolean) evt.getNewValue()) {
                setBorder(new javax.swing.border.LineBorder(new java.awt.Color(204, 204, 255), 0, true));
            } else {
                setBorder(new javax.swing.border.LineBorder(new java.awt.Color(204, 204, 255), 3, true));
            }
            
        }
    }//GEN-LAST:event_formPropertyChange

    private void jLstWuerfeValueChanged(javax.swing.event.ListSelectionEvent evt) {//GEN-FIRST:event_jLstWuerfeValueChanged
        if (jLstWuerfe.getSelectedIndex() < 0)
            return;
        if (zwinger.getWuerfe().size() < 0)
            return;
        Wurf wurf = zwinger.getWuerfe().get(jLstWuerfe.getSelectedIndex());
        if (wurf != null) {
            activWurf = wurf;
            loadWurf();
        }
        this.dataSaved = false;
    }//GEN-LAST:event_jLstWuerfeValueChanged

    private void jBtnWuerfeAddActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jBtnWuerfeAddActionPerformed
        Object wurfNameObject = this.jCbxWuerfe.getSelectedItem();
        if (wurfNameObject != null && wurfNameObject instanceof WurfNamen) {
            WurfNamen wurfName = (WurfNamen) wurfNameObject;
            Wurf wurf = new Wurf(wurfName);

            this.zwinger.getWuerfe().add(wurf);
            this.jLstWuerfe.updateUI();
            this.jLstWuerfe.setSelectedIndex(this.wurfListModel.getIndexAt(wurf));

            this.wurfNamenComboBoxModel.removeElement(wurfNameObject);
            this.jCbxWuerfe.setSelectedIndex(0);
            this.jCbxWuerfe.updateUI();
        }
        this.dataSaved = false;
    }//GEN-LAST:event_jBtnWuerfeAddActionPerformed

    private void jBtnWuerfeRemoveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jBtnWuerfeRemoveActionPerformed
        if (jLstWuerfe.getSelectedIndex() < 0)
            return;
        if (zwinger.getWuerfe().size()< 0)
            return;
        Wurf wurf = zwinger.getWuerfe().get(this.jLstWuerfe.getSelectedIndex());
        if (wurf == null)
            return;

        WurfNamen wurfName = wurf.getWurfName();
        this.wurfNamenComboBoxModel.addElement(wurfName);
        this.jLstWuerfe.clearSelection();
        this.zwinger.getWuerfe().remove(wurf);
        this.jLstWuerfe.updateUI();

        this.dataSaved = false;

    }//GEN-LAST:event_jBtnWuerfeRemoveActionPerformed

    private void jXMVBirthdayComponentResized(java.awt.event.ComponentEvent evt) {//GEN-FIRST:event_jXMVBirthdayComponentResized
        if (evt.getComponent().equals(this.jXMVBirthday)) {
            long fdate = this.jXMVBirthday.getFirstDisplayedDay().getTime();
            long ldate = this.jXMVBirthday.getLastDisplayedDay().getTime();
            long today = DateUtils.getNextMonth(new Date().getTime());
            this.jXMVBirthday.setFirstDisplayedDay(new Date(today - (ldate - fdate)));

        }
    }//GEN-LAST:event_jXMVBirthdayComponentResized

    private void jLstWelpenValueChanged(javax.swing.event.ListSelectionEvent evt) {//GEN-FIRST:event_jLstWelpenValueChanged
        if (activWurf == null)
            return;
        if (jLstWelpen.getSelectedIndex() < 0)
            return;
        if (activWurf.getWelpen().size() < 0)
            return;
        Welpe welpe = activWurf.getWelpen().get(jLstWelpen.getSelectedIndex());
        if (welpe != null) {
            activWelpe = welpe;
            loadWelpe();
        }

        this.dataSaved = false;
    }//GEN-LAST:event_jLstWelpenValueChanged

    private void jBtnWelpenAddActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jBtnWelpenAddActionPerformed
        if (activWurf == null)
            return;
        String name = "Welpe" + String.valueOf(activWurf.getWelpen().size() + 1);
        Welpe welpe = new Welpe(name);
        this.activWurf.getWelpen().add(welpe);
        this.activWelpe = welpe;
        this.jLstWelpen.updateUI();
        this.jLstWelpen.setSelectedIndex(this.welpeListModel.getIndexAt(welpe));

        this.dataSaved = false;
    }//GEN-LAST:event_jBtnWelpenAddActionPerformed

    private void jBtnWelpenRemoveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jBtnWelpenRemoveActionPerformed
        if (jLstWelpen.getSelectedIndex() < 0)
            return;
        if (activWurf == null)
            return;
        if (activWurf.getWelpen().size() < 0)
            return;
        Welpe welpe = activWurf.getWelpen().get(this.jLstWelpen.getSelectedIndex());
        if (welpe == null)
            return;
        this.jLstWelpen.clearSelection();
        activWurf.getWelpen().remove(welpe);
        this.jLstWelpen.updateUI();

        this.dataSaved = false;
    }//GEN-LAST:event_jBtnWelpenRemoveActionPerformed

    private void jTxtWelpeNameCaretUpdate(javax.swing.event.CaretEvent evt) {//GEN-FIRST:event_jTxtWelpeNameCaretUpdate
        if (activWelpe == null)
            return;
        if (jTxtWelpeName.getText().isEmpty())
            return;
        activWelpe.setName(jTxtWelpeName.getText());
        jLstWelpen.updateUI();
        this.dataSaved = false;
    }//GEN-LAST:event_jTxtWelpeNameCaretUpdate

    private void jTxtWelpeNameFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jTxtWelpeNameFocusGained
        if (jTxtWelpeName.getText().startsWith("Welpe"))
            jTxtWelpeName.setText("");
        this.dataSaved = false;
    }//GEN-LAST:event_jTxtWelpeNameFocusGained

    private void jTxtWelpeNameFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jTxtWelpeNameFocusLost
        if (activWelpe == null)
            return;
        if (jTxtWelpeName.getText().isEmpty()) {
            jTxtWelpeName.setText(activWelpe.getName());
            return;
        }

        activWelpe.setName(jTxtWelpeName.getText());
        jLstWelpen.updateUI();
        this.dataSaved = false;
    }//GEN-LAST:event_jTxtWelpeNameFocusLost

    private void jTxtWelpeNameActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jTxtWelpeNameActionPerformed
        if (activWelpe == null)
            return;
        activWelpe.setName(jTxtWelpeName.getText());
        jLstWelpen.updateUI();
        this.dataSaved = false;
    }//GEN-LAST:event_jTxtWelpeNameActionPerformed

    private void jCbxWelpeGenderItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_jCbxWelpeGenderItemStateChanged
        if (activWelpe == null)
            return;
        Object genderObject = this.jCbxWelpeGender.getSelectedItem();
        if (genderObject != null && genderObject instanceof Gender)
            activWelpe.setGeschlecht((Gender) genderObject);
        this.dataSaved = false;
    }//GEN-LAST:event_jCbxWelpeGenderItemStateChanged

    private void jCbxWelpeGenderActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jCbxWelpeGenderActionPerformed

    }//GEN-LAST:event_jCbxWelpeGenderActionPerformed

    private void jTxtWelpeExtrasCaretUpdate(javax.swing.event.CaretEvent evt) {//GEN-FIRST:event_jTxtWelpeExtrasCaretUpdate
        if (activWelpe == null)
            return;
        activWelpe.setBesonderheiten(jTxtWelpeExtras.getText());
        this.dataSaved = false;
    }//GEN-LAST:event_jTxtWelpeExtrasCaretUpdate

    private void jLstWelpeTestsMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jLstWelpeTestsMouseClicked
        if (evt.getButton() == java.awt.event.MouseEvent.BUTTON1 && evt.getClickCount() == 2) {
            if (this.getParent() == null)
                return;
            ILeDesktopPane tb = (ILeDesktopPane) this.getParent();

            if (jLstWelpeTests.getSelectedIndex() < 0)
                return;
            if (activWelpe == null)
                return;
            if (activWelpe.getvTest().size() < 0)
                return;
            VTestData vtest = activWelpe.getvTest().get(this.jLstWelpeTests.getSelectedIndex());
            if (vtest == null)
                return;
            if (vtest instanceof VePTestData) {
                VePTestData data = (VePTestData) vtest;
                if (!data.getCrossBorder().isEmpty()) {
                    VePDataFrame dataFrame = new VePDataFrame(data);
                    dataFrame.setTitle(zwinger.getName() + " | " + activWurf.getWurfName().getName() + " | " + activWelpe.getName() + " | " + vtest.toString());
                    tb.add(dataFrame);
                    dataFrame.show();
                } else {
                    if (vepTest == null) {
                        vepTest = new VePTestFrame();
                        this.getParent().add(vepTest);
                    }
                    this.vepTest.setVTestData(data);
                    vepTest.setTitle(zwinger.getName() + " | " + activWurf.getWurfName().getName() + " | " + activWelpe.getName() + " | " + vtest.toString());
                    vepTest.show();
                }
            } else if (vtest instanceof V6MTestData) {
//                V6MTest v6mtest =  new de.abring.welpentest.gui.component.V6MTest((V6MTestData) vtest, this);
//                tb.addTab(zwinger.getName() + " | " + activWurf.getWurfName().getName() + " | " + activWelpe.getName() + " | " + vtest.toString(), v6mtest);
//                tb.setSelectedComponent(v6mtest);
            }
        }

    }//GEN-LAST:event_jLstWelpeTestsMouseClicked

    private void jBtnWelpeVePAddActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jBtnWelpeVePAddActionPerformed
        if (activWelpe == null)
        return;
        
        
        
        VTestData vtest = (VTestData) new VePTestData();
        //VePTest vtest = new VePTest();
        this.activWelpe.getvTest().add(vtest);
        this.jLstWelpeTests.updateUI();
        this.jLstWelpeTests.setSelectedIndex(this.testListModel.getIndexAt(vtest));

        this.dataSaved = false;
    }//GEN-LAST:event_jBtnWelpeVePAddActionPerformed

    private void jBtnWelpeV6MAddActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jBtnWelpeV6MAddActionPerformed
        if (activWelpe == null)
        return;
        VTestData vtest = (VTestData) new V6MTestData();
        //VePTest vtest = new VePTest();
        this.activWelpe.getvTest().add(vtest);
        this.jLstWelpeTests.updateUI();
        this.jLstWelpeTests.setSelectedIndex(this.testListModel.getIndexAt(vtest));

        this.dataSaved = false;
    }//GEN-LAST:event_jBtnWelpeV6MAddActionPerformed

    private void jBtnWelpeTestRemoveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jBtnWelpeTestRemoveActionPerformed
        if (jLstWelpeTests.getSelectedIndex() < 0)
        return;
        if (activWelpe == null)
        return;
        if (activWelpe.getvTest().size() < 0)
        return;
        VTestData vtest = activWelpe.getvTest().get(this.jLstWelpeTests.getSelectedIndex());
        if (vtest == null)
        return;
        this.jLstWelpeTests.clearSelection();
        activWelpe.getvTest().remove(vtest);
        this.jLstWelpeTests.updateUI();

        this.dataSaved = false;
    }//GEN-LAST:event_jBtnWelpeTestRemoveActionPerformed

    private void jTxtZwingerNameCaretUpdate(javax.swing.event.CaretEvent evt) {//GEN-FIRST:event_jTxtZwingerNameCaretUpdate
        if (jTxtZwingerName.getText().isEmpty())
        return;
        this.zwinger.setName(this.jTxtZwingerName.getText());

        if (this.getParent() == null)
        return;
        setTitle(this.zwinger.getName());
        this.dataSaved = false;
    }//GEN-LAST:event_jTxtZwingerNameCaretUpdate

    private void jTxtZwingerNameFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jTxtZwingerNameFocusGained
        if (jTxtZwingerName.getText().startsWith("neuer Zwinger"))
        jTxtZwingerName.setText("");
        this.dataSaved = false;
    }//GEN-LAST:event_jTxtZwingerNameFocusGained

    private void jTxtZwingerNameFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jTxtZwingerNameFocusLost
        if (jTxtZwingerName.getText().isEmpty()) {
            this.jTxtZwingerName.setText(this.zwinger.getName());
            return;
        }
        this.zwinger.setName(this.jTxtZwingerName.getText());
        if (this.getParent() == null)
        return;
        setTitle(this.zwinger.getName());
        this.dataSaved = false;
    }//GEN-LAST:event_jTxtZwingerNameFocusLost

    private void jTxtZwingerNameActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jTxtZwingerNameActionPerformed
        this.zwinger.setName(this.jTxtZwingerName.getText());
        this.dataSaved = false;
    }//GEN-LAST:event_jTxtZwingerNameActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jBtnWelpeTestRemove;
    private javax.swing.JButton jBtnWelpeV6MAdd;
    private javax.swing.JButton jBtnWelpeVePAdd;
    private javax.swing.JButton jBtnWelpenAdd;
    private javax.swing.JButton jBtnWelpenRemove;
    private javax.swing.JButton jBtnWuerfeAdd;
    private javax.swing.JButton jBtnWuerfeRemove;
    private javax.swing.JComboBox<String> jCbxWelpeGender;
    private javax.swing.JComboBox<String> jCbxWuerfe;
    private javax.swing.JList<String> jLstWelpeTests;
    private javax.swing.JList<String> jLstWelpen;
    private javax.swing.JList<String> jLstWuerfe;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanelWelpen;
    private javax.swing.JPanel jPneBirthday;
    private javax.swing.JPanel jPneWelpe;
    private javax.swing.JPanel jPneWelpeExtras;
    private javax.swing.JPanel jPneWelpeTests;
    private javax.swing.JPanel jPneWuerfe;
    private javax.swing.JScrollPane jSclPaneWelpeExtras;
    private javax.swing.JScrollPane jSclPneWelpeTests;
    private javax.swing.JScrollPane jSclPneWelpen;
    private javax.swing.JScrollPane jSclPneWuerfe;
    private javax.swing.JTextArea jTxtWelpeExtras;
    private javax.swing.JTextField jTxtWelpeName;
    private javax.swing.JTextField jTxtZwingerName;
    private org.jdesktop.swingx.JXMonthView jXMVBirthday;
    // End of variables declaration//GEN-END:variables

    
    public void updateLst() {
        this.jLstWelpeTests.updateUI();
//        this.jLstWelpeTests.setSelectedIndex(this.testListModel.getIndexAt(vtest));
    }
    /**
     * @return the activWurf
     */
    public Wurf getActivWurf() {
        return activWurf;
    }

    /**
     * @param activWurf the activWurf to set
     */
    public void setActivWurf(Wurf activWurf) {
        this.activWurf = activWurf;
    }

    /**
     * @return the activWelpe
     */
    public Welpe getActivWelpe() {
        return activWelpe;
    }

    /**
     * @param activWelpe the activWelpe to set
     */
    public void setActivWelpe(Welpe activWelpe) {
        this.activWelpe = activWelpe;
    }

    /**
     * @return the filename
     */
    public File getFilename() {
        return filename;
    }

    /**
     * @param filename the filename to set
     */
    public void setFilename(File filename) {
        this.filename = filename;
    }

    /**
     * @return the zwinger
     */
    public Zwinger getZwinger() {
        return zwinger;
    }

    private void loadZwinger() {
        if (zwinger == null)
            return;
        this.jTxtZwingerName.setText(zwinger.getName());
        this.wurfListModel = new WurfListModel(zwinger.getWuerfe());
        this.jLstWuerfe.setModel(wurfListModel);
        this.jLstWuerfe.updateUI();
        if (zwinger.getWuerfe().size() > 0) {
            this.jLstWelpen.setSelectedIndex(0);
        }
    }
    
    private void loadWurf() {
        if (activWurf == null)
            return;
        
        this.jXMVBirthday.setFlaggedDates(activWurf.getGeburtstag());
        this.jXMVBirthday.setSelectionDate(activWurf.getGeburtstag());
        
        this.welpeListModel = new WelpeListModel(activWurf.getWelpen());
        this.jLstWelpen.setModel(welpeListModel);
        this.jLstWelpen.updateUI();
        
        if (activWurf.getWelpen().size() > 0) {
            this.jLstWelpen.setSelectedIndex(0);
        } else {
            this.jTxtWelpeName.setText("");
            this.jTxtWelpeExtras.setText("");
            this.genderComboBoxModel.setSelectedItem(Gender.GENDER_UNDEFINED);
            this.jCbxWelpeGender.updateUI();
        }
    }

    private void loadWelpe() {
        if (activWelpe == null)
            return;
        
        this.jTxtWelpeName.setText(activWelpe.getName());
        
        this.jTxtWelpeExtras.setText(activWelpe.getBesonderheiten());
        
        this.genderComboBoxModel.setSelectedItem(activWelpe.getGeschlecht());
        this.jCbxWelpeGender.updateUI();
        
        this.testListModel = new TestListModel(activWelpe.getvTest());
        this.jLstWelpeTests.setModel(testListModel);
        this.jLstWelpeTests.updateUI();
    }
    
    public void saveMain() {
        File file = this.filename;
        if (file == null)
            return;
        if (!file.exists())
            file = FileIO.getSavePuppieTestFile(this, new File(this.zwinger.getName()), "");
        if (file == null)
            return;
        
        try (FileOutputStream fos = new FileOutputStream (file);
            ObjectOutputStream oos = new ObjectOutputStream (fos)) {
            oos.writeObject (this.zwinger);
            this.dataSaved = true;
            this.filename = file;
        } catch (IOException ex) {
            Logger.getLogger(Welpentest.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
    
    public void saveAsMain() {
        File file = FileIO.getSavePuppieTestFile(this, new File(this.zwinger.getName()), "");
        if (file == null)
            return;
        
        try (FileOutputStream fos = new FileOutputStream (file);
            ObjectOutputStream oos = new ObjectOutputStream (fos)) {
            oos.writeObject (this.zwinger);
            this.dataSaved = true;
            this.filename = file;
        } catch (IOException ex) {
            Logger.getLogger(Welpentest.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
}
